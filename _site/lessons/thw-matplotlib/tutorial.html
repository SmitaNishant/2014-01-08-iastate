<!DOCTYPE html>
<html>
  <head>
    <link rel="shortcut icon" type="image/x-icon" href="../../favicon.ico" />
<link href="../../css/bootstrap/bootstrap.css" rel="stylesheet" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<link href="../../css/bootstrap/bootstrap-responsive.css" rel="stylesheet" />
<link rel="stylesheet" type="text/css" href="../../css/swc.css" />
<link rel="stylesheet" type="text/css" href="../../css/swc-bootstrap.css" />
<link rel="alternate" type="application/rss+xml" title="The Software Carpentry Blog" href="/feed.xml"/>
<meta http-equiv="last-modified" content="" />
<!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
<!--[if lt IE 9]>
  <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
<![endif]-->

  </head>
  <body>
    <div class="container">
      <div class="banner">
  <a href="http://software-carpentry.org" title="Software Carpentry">
    <img alt="Software Carpentry banner" src="../../img/software-carpentry-banner.png" />
  </a>
</div>


      <div class="row-fluid">
        <div class="span10 offset1">
          <h1>Plotting in Python with matplotlib</h1>
          <p><strong>Based on Lecture Material by Anthony Scopatz and Katy Huff</strong></p>

<h1>Plotting in Python</h1>

<p>Do this while I talk. If this is your first use of matplotlib (ever on
this machine), it will take a little longer starting up.</p>
<div class="highlight"><pre><code class="python language-python" data-lang="python"><span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> 
</code></pre></div>
<p>The ability to visually represent data is one of the more important
tools to the scientific user of python. The most popular and arguably
most mature library for producing publication quality 2D plots
matplotlib (MatPlotLib). In the developers own words, MatPlotLib is</p>

<blockquote>
<p>a python 2D plotting library which produces publication quality
figures in a variety of hardcopy formats and interactive environments
across platforms. matplotlib can be used in python scripts, the python
and ipython shell (ala MatLab or mathematica), web application
servers, and six graphical user interface toolkits.&quot;</p>
</blockquote>

<h2>pyplot, pylab and matplotlib. numpy, MatLab and more...</h2>

<p>The underlying structure of MatPlotLib is very general and customizable.
Thankfully, you don&#39;t actually need to interact with all that power. The
way to generate plots and modify them is through the pyplot interface.
The pyplot interface is much much inspired by Matlab&#39;s plotting
commands, so it should if you&#39;re familiar with that it should be easy to
pick up.</p>

<ul>
<li>  matplotlib - raw access to the plotting library. useful for
extending matplotlib or doing very custom things</li>
<li>  pyplot - MatLab-like interface to matplotlib (use this one!)</li>
<li>  pylab - pyplot + numpy</li>
</ul>

<p><strong>Aside: Multiple Interfaces to MatPlotLib</strong></p>

<p>In addition to the object oriented pyplot interface, pyplot implements a
clone of Matlab&#39;s plotting interface. The main difference is that the
Matlab interface has the paradigm of the &quot;current figure.&quot; So plotting
and labeling commands implicitly refer to the current figure/subplot.
This is fine so long as your plotting commands are simple and
sequential. However, when your program requires that you modify a figure
in multiple contexts the Matlab interface becomes very difficult to keep
up with.</p>

<p>In this session, we will use the object oriented interface exclusively.
It is trivial to degrade to the Matlab interface if you&#39;re feeling lazy,
but the object oriented interface is powerful. It is also more explicit.</p>
<div class="highlight"><pre><code class="python language-python" data-lang="python"><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span> 
</code></pre></div>
<p>First things first. Let&#39;s plot something. Open up a file, copy, paste,
execute.</p>
<div class="highlight"><pre><code class="python language-python" data-lang="python">  <span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
  <span class="n">x</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
  <span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="n">val</span><span class="o">**</span><span class="mi">2</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">x</span><span class="p">]</span>
  <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
  <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>
<h2>figures, subplots, and axes</h2>

<p>MatPlotLib plots are organized into figures, subplots and axes.</p>

<p><img src="../../lessons/thw-scipy/images/fig1.jpg" alt=""></p>

<ul>
<li>  figure = the whole window (Figure 1 above)</li>
<li>  subplot = the regular grid of four plots (One, Two, Three, and Four
above) within the window</li>
<li>  axes = a handle to the place in the subplot to put your curves
(there are four axes defining the locations of the 6 curves above.)</li>
</ul>

<h3>Hands On Exercise : Making a Plot</h3>

<p>Lets make a plot. Retyping everything is not fun. Open up your favorite
text editor to create a file &quot;plot.py&quot; to hold your plotting script.</p>

<ol>
<li><p>from matplotlib import pyplot as plt</p></li>
<li><p>Make a figure: <strong>fig = plt.figure()</strong></p></li>
<li><p>Add a subplot to the figure: <strong>ax = fig.add_subplot(111)</strong></p></li>
<li><p>Plot on the subplot axes: <strong>ax.plot(range(10))</strong></p></li>
<li><p>Show the figure: <strong>plt.show()</strong></p>

<p>Your file should look like :</p>
<div class="highlight"><pre><code class="python language-python" data-lang="python">  <span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
  <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
  <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
  <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">])</span>
</code></pre></div></li>
<li><p>Run your python file from the terminal <strong>python plot.py &amp;</strong></p></li>
</ol>

<h2>Customizing your Figure</h2>

<p>Other, sometimes more convenient ways to get axes.</p>
<div class="highlight"><pre><code class="python language-python" data-lang="python">  <span class="c"># Useful for figures composed of multiple subplots</span>
  <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
  <span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">221</span><span class="p">)</span>
  <span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">222</span><span class="p">)</span>
  <span class="n">ax3</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">223</span><span class="p">)</span>
  <span class="n">ax4</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">224</span><span class="p">)</span>

  <span class="c"># Useful for figures with one subplot (ie the subplot is the figure)</span>
  <span class="n">ax2</span> <span class="o">=</span> <span class="n">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>

  <span class="c"># Useful for overlaying axes, sharing the x axis</span>
  <span class="n">ax3</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">twinx</span><span class="p">(</span><span class="n">ax2</span><span class="p">)</span>
</code></pre></div>
<h3>Customizing your Plot</h3>

<p>Plot is pretty powerful, lets peruse the <a href="http://matplotlib.sourceforge.net">MatPlotLib
documentation</a>.</p>

<ol>
<li> By editing plot.py and referencing the documentation try to add a
label to an axis or change the color.</li>
<li> If you&#39;re feeling adventurous and you&#39;ve successfully added a label,
try ax.legend()</li>
</ol>

<p>Hints:</p>

<ul>
<li>  legend</li>
<li>  colors</li>
<li>  linestyles</li>
<li>  kwargs !</li>
</ul>

<h1>Other Types of Line Plots</h1>

<p>MatPlotLib as all the usual types of plots</p>

<h2>log-linear, linear-log, log-log</h2>
<div class="highlight"><pre><code class="python language-python" data-lang="python">  <span class="n">ax</span><span class="o">.</span><span class="n">semilogx</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
  <span class="n">ax</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
  <span class="n">ax</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
</code></pre></div>
<p>Execute ax.semilogx(range(1,11),range(10)) within your script instead of
ax.plot(x) and run it again to see the effect.</p>

<h2>Contour plots and pcolor</h2>

<p>Notice that for the z argument to pcolor is shorter by one in both
directions. You should think of z as being defined zone centered. If you
forget to do so, it will drop the last row and column.</p>
<div class="highlight"><pre><code class="python language-python" data-lang="python">  <span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
  <span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>

  <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">200</span><span class="p">)</span>
  <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span><span class="mi">7</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span><span class="mi">200</span><span class="p">)</span>
  <span class="n">r</span><span class="p">,</span><span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">t</span><span class="p">)</span>
  <span class="n">x</span> <span class="o">=</span> <span class="n">r</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
  <span class="n">y</span> <span class="o">=</span> <span class="n">r</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
  <span class="n">z</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="mf">0.6</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">y</span><span class="o">-</span><span class="mf">1.</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>

  <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>

  <span class="n">ax</span><span class="o">.</span><span class="n">pcolor</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span><span class="mi">1</span><span class="p">:])</span>
  <span class="c"># ax.colorbar()</span>

  <span class="n">con</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">)</span>
  <span class="n">ax</span><span class="o">.</span><span class="n">clabel</span><span class="p">(</span><span class="n">con</span><span class="p">)</span>

  <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>
<h1>Random useful things</h1>

<h2>Spy</h2>

<p>Matlab converts may have used this function to look at the structure of sparse
<a href="http://www.merriam-webster.com/medical/matrixes">matrixes</a>.</p>
<div class="highlight"><pre><code class="python language-python" data-lang="python">  <span class="n">n</span> <span class="o">=</span> <span class="mi">20</span>
  <span class="n">f</span> <span class="o">=</span> <span class="n">diag</span><span class="p">(</span><span class="n">ones</span><span class="p">(</span><span class="n">n</span><span class="p">))</span> <span class="o">+</span> <span class="n">diag</span><span class="p">(</span><span class="n">ones</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">diag</span><span class="p">(</span><span class="n">ones</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">3</span><span class="p">),</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span>
  <span class="n">spy</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</code></pre></div>
<h2>Masked Arrays</h2>

<p>Masked arrays are numpy ndarrays that have a mask to hide elements of
the ndarray. They are really handy to use when plotting and you just
want to make particular parts of the plot &quot;go away.&quot; In theory you could
modify the underlying arrays to do the right thing, but that&#39;s a lot of
work. You shouldn&#39;t have to do it if you don&#39;t have to. Masked arrays are
the answer. For more detailed information, check out the <a href="http://docs.scipy.org/doc/numpy/reference/maskedarray.html">masked arrray
documentation</a>
] and <a href="http://docs.scipy.org/doc/numpy/reference/maskedarray.generic.html#constructing-masked-arrays">constructing masked
arrays</a>.</p>

<p>Starting from the pcolor plot, add the following code after defining z and
before plotting things.</p>
<div class="highlight"><pre><code class="python language-python" data-lang="python">  <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">masked_where</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">y</span><span class="o">-</span><span class="n">x</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.2</span><span class="p">,</span> <span class="n">z</span> <span class="p">)</span>
</code></pre></div>
<h2>draw() vs show()</h2>

<p>If you&#39;re changing plots after they render (ie show()) you have to tell
MatPlotLib to draw the plot. draw() forces a figure to redraw. If you&#39;re
doing all your plotting from scripts, you probably won&#39;t have to deal
with draw(). If you&#39;re programming figures such that they change over
the course of your program, you will need to use draw to refresh the
figure.</p>

<h1>How do I make a plot like ... ?</h1>

<p>MatPlotLib has an extensive
<a href="http://matplotlib.sourceforge.net/gallery.html">gallery</a> of plots with
source code. Take a look through those; they probably have something
similar to what you want to do. If you click on one of these images, you&#39;ll
land on a page with the source that created it. Recently, I&#39;ve noticed that
the server has been throttling my traffic. If you see one you like but get
a &quot;Too many requests warning&quot; go to the matplotlib github repository
(https://github.com/matplotlib/matplotlib/tree/master/examples/pylab_examples)
and look for the source code there.</p>

<p>My favorite, among these, is
<a href="https://github.com/matplotlib/matplotlib/tree/master/examples/pylab_examples/polar_bar.py">polar_bar.py</a>.</p>

<h1>Choose your own adventure</h1>

<ul>
<li>  keyboard/mouse bindings (interactive plots!)</li>
<li>  <a href="http://matplotlib.sourceforge.net/users/image_tutorial.html">image
plotting</a></li>
<li>  Shared Axes Across Subplots</li>
</ul>

<h1>Event binding with MatPlotLib</h1>

<p>MatPlotLib has a built in mechanism for handling keyboard/mouse events
in a platform independent way. This can be useful when you want to
toggle different data on and off in the same figure, or step through
time dependent data, or something else crazy that you dream up. All you
need a a function that draws the figure and some logic to identify
events that your care about. MatPlotLib handles the rest. Lets walk
through the following code.</p>

<ul>
<li>  A MovingPlot instance remembers which plot and axes to modify (no
current figure nonsense!)</li>
<li>  In the constructor, we draw() the initial frame</li>
<li>  The attribute cid listens for &quot;key press events&quot; and calls
self.update(event) when something happens</li>
<li>  event is a &#39;key_press_event&#39; object, with attributes like &quot;key&quot;</li>
<li>  update() takes one argument: an event object (other than the
unavoidable self)</li>
<li>  Based on the event object passed, update() only does something on
right and left arrow key presses</li>
<li>  MatPlotLib has several other <a href="http://matplotlib.sourceforge.net/api/backend_bases_api.html?highlight=canvas#matplotlib.backend_bases.FigureCanvasBase.mpl_connect">supported events</a></li>
</ul>
<div class="highlight"><pre><code class="python language-python" data-lang="python">  <span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
  <span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>

  <span class="k">class</span> <span class="nc">MovingPlot</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot; MovingPlot plots a figure that flows across the screen.  Right and left </span>
<span class="sd">  arrows move the figure one step&quot;&quot;&quot;</span>
      <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">r0</span><span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span> <span class="n">v0</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]):</span>
          <span class="c"># set up grid</span>
          <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">20</span><span class="p">)</span>
          <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
          <span class="n">r</span><span class="p">,</span><span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">t</span><span class="p">)</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">r</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">r</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>

          <span class="bp">self</span><span class="o">.</span><span class="n">x0</span> <span class="o">=</span> <span class="n">r0</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">y0</span> <span class="o">=</span> <span class="n">r0</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">vx</span> <span class="o">=</span> <span class="n">v0</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">vy</span> <span class="o">=</span> <span class="n">v0</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

          <span class="c"># create figure and axes for reuse</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>

          <span class="c"># draw the initial frame</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">frame</span> <span class="o">=</span> <span class="mi">0</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="p">)</span>

          <span class="c"># call self.update everytime a &#39;key_press_event&#39; happens</span>
          <span class="c"># bind this behavior to an object so it persists</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">cid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">mpl_connect</span><span class="p">(</span><span class="s">&#39;key_press_event&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">)</span>
          <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

      <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
          <span class="sd">&quot;&quot;&quot;Changes the frame number based on event and draws a new frame if the </span>
<span class="sd">          frame changed&quot;&quot;&quot;</span>
          <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">key</span> <span class="o">==</span>  <span class="s">&#39;right&#39;</span><span class="p">:</span>
              <span class="k">print</span> <span class="s">&#39;forward&#39;</span>
              <span class="bp">self</span><span class="o">.</span><span class="n">frame</span> <span class="o">+=</span> <span class="mi">1</span>
          <span class="k">elif</span> <span class="n">event</span><span class="o">.</span><span class="n">key</span> <span class="o">==</span> <span class="s">&#39;left&#39;</span><span class="p">:</span>
              <span class="k">print</span> <span class="s">&#39;backward&#39;</span>
              <span class="bp">self</span><span class="o">.</span><span class="n">frame</span> <span class="o">-=</span> <span class="mi">1</span>
          <span class="k">else</span><span class="p">:</span>
              <span class="k">return</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="p">)</span>

      <span class="k">def</span> <span class="nf">draw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
          <span class="sd">&quot;&quot;&quot;Draws the frame occuring at time=t&quot;&quot;&quot;</span>
          <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">vx</span><span class="o">*</span><span class="n">t</span>
          <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">vy</span><span class="o">*</span><span class="n">t</span>
          <span class="n">z</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">x0</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">y</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">y0</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">pcolor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

  <span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&quot;__main__&quot;</span><span class="p">:</span>
      <span class="n">mplot</span> <span class="o">=</span> <span class="n">MovingPlot</span><span class="p">()</span>
</code></pre></div>
<h1>Image Manipulation</h1>

<p>MatPlotLib has the ability to plot images. Check out the following code.
It plots 4 subplots</p>

<ul>
<li>  an image of a bunny</li>
<li>  an image of a bunny with stuff over plotted</li>
<li>  an image of a generated array</li>
<li>  a pcolor plot of the same data</li>
</ul>
<div class="highlight"><pre><code class="python language-python" data-lang="python">  <span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
  <span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
  <span class="kn">import</span> <span class="nn">urllib</span>

  <span class="c"># read png into img</span>
  <span class="k">try</span><span class="p">:</span>
      <span class="n">img</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="s">&#39;bunny.png&#39;</span><span class="p">)</span>
  <span class="k">except</span> <span class="ne">RuntimeError</span><span class="p">:</span>
      <span class="k">print</span> <span class="s">&quot;can&#39;t find bunny.png, trying to download&quot;</span>
      <span class="c"># the image probably doesn&#39;t exits</span>
      <span class="n">url</span> <span class="o">=</span> 
      <span class="s">&#39;http://github.com/thehackerwithin/PyTrieste.wiki/images/bunny.png&#39;</span>
      <span class="n">urllib</span><span class="o">.</span><span class="n">urlretrieve</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s">&#39;bunny.png&#39;</span><span class="p">)</span>
      <span class="n">img</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="s">&#39;bunny.png&#39;</span><span class="p">)</span>

  <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>

  <span class="c"># plot just the bunny</span>
  <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">221</span><span class="p">)</span>
  <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
  <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">&#39;just the bunny&#39;</span><span class="p">)</span>

  <span class="c"># plot bunny with stuff on top</span>
  <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">223</span><span class="p">)</span>
  <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
  <span class="n">xmin</span><span class="p">,</span><span class="n">xmax</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()</span> <span class="c"># plot changes the plotting limits</span>
  <span class="n">ymin</span><span class="p">,</span><span class="n">ymax</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span> <span class="c"># snag them here for future uses</span>
  <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">700</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
  <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="o">/</span><span class="mi">100</span><span class="p">)</span><span class="o">*</span><span class="mi">300</span> <span class="o">+</span> <span class="mi">300</span>
  <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
  <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">xmin</span><span class="p">,</span><span class="n">xmax</span><span class="p">)</span> <span class="c"># reset the limits to what imshow would have them be</span>
  <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ymin</span><span class="p">,</span><span class="n">ymax</span><span class="p">)</span>
  <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">&#39;bunny with overlaid plots&#39;</span><span class="p">)</span>

  <span class="c"># plot an array of doubles</span>
  <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">222</span><span class="p">)</span>
  <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">200</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
  <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">200</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
  <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
  <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="o">/</span><span class="mf">200.</span> <span class="o">*</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">y</span><span class="o">/</span><span class="mf">200.</span> <span class="o">*</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">*</span> <span class="n">x</span><span class="o">/</span><span class="mi">200</span> <span class="o">*</span> <span class="n">y</span><span class="o">/</span><span class="mi">200</span>
  <span class="n">image</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
  <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">&#39;imshow() of array&#39;</span><span class="p">)</span>

  <span class="c"># plot pcolor of z</span>
  <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">224</span><span class="p">)</span>
  <span class="n">image</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">pcolor</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
  <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">&#39;pcolor() of same array array&#39;</span><span class="p">)</span>

  <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>
<h1>Shared Axes Across Subplots</h1>

<p>Take a look at the following plotting script. It plots 4 subplots. If
the bottom left subplot is the anchor, 1 subplot shares the xaxis (top
left). 1 subplot shares the yaxis (bottom right). 1 subplot shares both
axes (top right).</p>
<div class="highlight"><pre><code class="python language-python" data-lang="python">  <span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
  <span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>

  <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">)</span>
  <span class="n">s1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>
  <span class="n">s2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">t</span><span class="p">)</span>
  <span class="n">s3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>

  <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
  <span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">223</span><span class="p">)</span>
  <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">s1</span><span class="p">)</span>
  <span class="n">ax1</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">&#39;k&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
  <span class="n">ax1</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">&#39;r&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

  <span class="c">## share x only</span>
  <span class="n">ax2</span><span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">221</span><span class="p">,</span> <span class="n">sharex</span>
  <span class="n">ax1</span><span class="p">)</span>
  <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">s2</span><span class="p">)</span>
  <span class="n">ax2</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">&#39;k&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
  <span class="n">ax2</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">&#39;r&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span> <span class="mi">3</span><span class="p">)</span>
  <span class="c"># make x tick labels invisible</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span> <span class="n">ax2</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">(),</span> <span class="n">visible</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

  <span class="c">## share x and y</span>
  <span class="n">ax3</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">222</span><span class="p">,</span>  <span class="n">sharex</span><span class="o">=</span> <span class="n">ax1</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="n">ax1</span><span class="p">)</span>
  <span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">s3</span><span class="p">)</span>
  <span class="n">ax3</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">&#39;k&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
  <span class="n">ax3</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span> <span class="s">&#39;r&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
  <span class="n">ax3</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span><span class="mf">5.0</span><span class="p">)</span>
  <span class="c"># make tick labels small</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span> <span class="n">ax3</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">(),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span> <span class="n">ax3</span><span class="o">.</span><span class="n">get_yticklabels</span><span class="p">(),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>

  <span class="c">## share y only</span>
  <span class="n">ax4</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add</span><span class="o">=</span><span class="n">subplot</span><span class="p">(</span><span class="mi">224</span><span class="p">,</span> <span class="n">sharey</span> <span class="o">=</span> <span class="n">ax1</span><span class="p">)</span>
  <span class="n">ax4</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">s3</span><span class="p">)</span>
  <span class="n">ax4</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span> <span class="s">&#39;k&#39;</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span>
  <span class="n">ax4</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span> <span class="s">&#39;r&#39;</span><span class="p">,</span> <span class="n">lw</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span>
  <span class="c"># make y tick labels invisible</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span> <span class="n">ax4</span><span class="o">.</span><span class="n">get_yticklabels</span><span class="p">(),</span> <span class="n">visible</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

  <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>
	</div>
      </div>

      <div class="footer">
  <a class="label swc-blue-bg" href="https://www.facebook.com/SoftwareCarpentry">Facebook</a>
  <a class="label swc-blue-bg" href="https://plus.google.com/u/0/114244759874490019250/posts">Google+</a>
  <a class="label swc-blue-bg" href="https://twitter.com/swcarpentry">Twitter</a>
  <a class="label swc-blue-bg" href="https://github.com/swcarpentry">GitHub</a>
  <a class="label swc-blue-bg" href="http://software-carpentry.org/feed.xml">RSS</a>
  <a class="label swc-blue-bg" href="../../license.html">License</a>
  <a class="bugreport label swc-blue-bg" href="mailto:info@software-carpentry.org?subject=bug%20in%20lessons/thw-matplotlib/tutorial.md">Bug Report</a>
</div>

    </div>
    <!-- Le javascript
================================================== -->
<!-- Placed at the end of the document so the pages load faster -->
<script src="../../js/jquery-1.9.1.min.js"></script>
<script src="../../js/bootstrap/bootstrap.min.js"></script>

  </body>
</html>
