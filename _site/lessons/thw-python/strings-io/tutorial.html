<!DOCTYPE html>
<html>
  <head>
    <link rel="shortcut icon" type="image/x-icon" href="../../../favicon.ico" />
<link href="../../../css/bootstrap/bootstrap.css" rel="stylesheet" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<link href="../../../css/bootstrap/bootstrap-responsive.css" rel="stylesheet" />
<link rel="stylesheet" type="text/css" href="../../../css/swc.css" />
<link rel="stylesheet" type="text/css" href="../../../css/swc-bootstrap.css" />
<link rel="alternate" type="application/rss+xml" title="The Software Carpentry Blog" href="/feed.xml"/>
<meta http-equiv="last-modified" content="" />
<!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
<!--[if lt IE 9]>
  <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
<![endif]-->

  </head>
  <body>
    <div class="container">
      <div class="banner">
  <a href="http://software-carpentry.org" title="Software Carpentry">
    <img alt="Software Carpentry banner" src="../../../img/software-carpentry-banner.png" />
  </a>
</div>


      <div class="row-fluid">
        <div class="span10 offset1">
          <h1>Strings and File I/O in Python</h1>
          <p><strong>Prepared by Tommy Guy</strong></p>

<p>Lesson goals:</p>

<ol>
<li> Examine the string class in greater detail.</li>
<li> Use open() to open, read, and write to files.</li>
</ol>

<h2>Strings</h2>

<p>To start understanding the String class, let&#39;s use the built in help
system.</p>
<div class="highlight"><pre><code class="python language-python" data-lang="python">  <span class="o">&gt;</span> <span class="n">help</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
 <span class="n">Help</span> <span class="n">on</span> <span class="k">class</span> <span class="nc">str</span> <span class="ow">in</span> <span class="n">module</span> <span class="n">__builtin__</span><span class="p">:</span>

 <span class="k">class</span> <span class="nc">str</span><span class="p">(</span><span class="nb">basestring</span><span class="p">)</span>
  <span class="o">|</span>  <span class="nb">str</span><span class="p">(</span><span class="nb">object</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">string</span>
  <span class="o">|</span>  
  <span class="o">|</span>  <span class="n">Return</span> <span class="n">a</span> <span class="n">nice</span> <span class="n">string</span> <span class="n">representation</span> <span class="n">of</span> <span class="n">the</span> <span class="nb">object</span><span class="o">.</span>
  <span class="o">|</span>  <span class="n">If</span> <span class="n">the</span> <span class="n">argument</span> <span class="ow">is</span> <span class="n">a</span> <span class="n">string</span><span class="p">,</span> <span class="n">the</span> <span class="k">return</span> <span class="n">value</span> <span class="ow">is</span> <span class="n">the</span> <span class="n">same</span> <span class="nb">object</span><span class="o">.</span>
  <span class="o">|</span>  
  <span class="o">|</span>  <span class="n">Method</span> <span class="n">resolution</span> <span class="n">order</span><span class="p">:</span>
  <span class="o">|</span>      <span class="nb">str</span>
  <span class="o">|</span>      <span class="nb">basestring</span>
  <span class="o">|</span>      <span class="nb">object</span>
  <span class="o">|</span>  
  <span class="o">|</span>  <span class="n">Methods</span> <span class="n">defined</span> <span class="n">here</span><span class="p">:</span>
  <span class="o">|</span>  
  <span class="o">|</span>  <span class="n">__add__</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
  <span class="o">|</span>      <span class="n">x</span><span class="o">.</span><span class="n">__add__</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">&lt;==&gt;</span> <span class="n">x</span><span class="o">+</span><span class="n">y</span>
  <span class="o">|</span>  
  <span class="o">|</span>  <span class="n">__contains__</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
  <span class="o">|</span>      <span class="n">x</span><span class="o">.</span><span class="n">__contains__</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">&lt;==&gt;</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">x</span>
  <span class="o">|</span>  
  <span class="o">|</span>  <span class="n">__eq__</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
  <span class="o">|</span>      <span class="n">x</span><span class="o">.</span><span class="n">__eq__</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">&lt;==&gt;</span> <span class="n">x</span><span class="o">==</span><span class="n">y</span>
  <span class="o">|</span>  
  <span class="o">|</span>  <span class="n">__format__</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
  <span class="o">|</span>      <span class="n">S</span><span class="o">.</span><span class="n">__format__</span><span class="p">(</span><span class="n">format_spec</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">unicode</span>
  <span class="o">|</span>  
  <span class="o">|</span>   <span class="n">__ge__</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
  <span class="o">|</span>      <span class="n">x</span><span class="o">.</span><span class="n">__ge__</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">&lt;==&gt;</span> <span class="n">x</span><span class="o">&gt;=</span><span class="n">y</span>
  <span class="o">|</span>  
  <span class="o">|</span>  <span class="n">__getattribute__</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
  <span class="o">|</span>      <span class="n">x</span><span class="o">.</span><span class="n">__getattribute__</span><span class="p">(</span><span class="s">&#39;name&#39;</span><span class="p">)</span> <span class="o">&lt;==&gt;</span> <span class="n">x</span><span class="o">.</span><span class="n">name</span>
  <span class="o">|</span>  <span class="p">]]</span>
  <span class="o">|</span>  <span class="n">__getitem__</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
  <span class="o">|</span>      <span class="n">x</span><span class="o">.</span><span class="n">__getitem__</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">&lt;==&gt;</span> <span class="n">x</span><span class="p">[</span><span class="n">y</span><span class="p">]</span>
  <span class="o">|</span>  
  <span class="o">|</span>  <span class="n">__getnewargs__</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
  <span class="o">|</span>  
  <span class="o">|</span>  <span class="n">__getslice__</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
  <span class="o">|</span>      <span class="n">x</span><span class="o">.</span><span class="n">__getslice__</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="o">&lt;==&gt;</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">j</span><span class="p">]</span>
  <span class="o">|</span>      
  <span class="o">|</span>      <span class="n">Use</span> <span class="n">of</span> <span class="n">negative</span> <span class="n">indices</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">supported</span><span class="o">.</span>
  <span class="o">|</span>  
  <span class="o">...</span>
</code></pre></div>
<p>The help page for string is very long, and it may be easier to keep it open
in a browser window by going to the <a href="http://docs.python.org/library/stdtypes.html#sequence-types-str-unicode-list-tuple-bytearray-buffer-xrange">online Python
documentation</a>
while we talk about its properties.</p>

<p>At its heart, a string is just a sequence of characters. Basic strings are
defined using single or double quotes.</p>
<div class="highlight"><pre><code class="python language-python" data-lang="python">    <span class="o">&gt;</span> <span class="n">s</span> <span class="o">=</span> <span class="s">&quot;This is a string.&quot;</span>
    <span class="o">&gt;</span> <span class="n">s2</span> <span class="o">=</span> <span class="s">&#39;This is another string that uses single quotes&#39;</span>
</code></pre></div>
<p>The reason for having two types of quotes to define a string is
emphasized in these examples:</p>
<div class="highlight"><pre><code class="python language-python" data-lang="python">    <span class="o">&gt;</span> <span class="n">s</span> <span class="o">=</span> <span class="s">&quot;Bob&#39;s mom called to say hello.&quot;</span>
    <span class="o">&gt;</span> <span class="n">s</span> <span class="o">=</span> <span class="s">&#39;Bob&#39;</span><span class="n">s</span> <span class="n">mom</span> <span class="n">called</span> <span class="n">to</span> <span class="n">say</span> <span class="n">hello</span><span class="o">.</span><span class="s">&#39;</span>
</code></pre></div>
<p>The second one should be an error: Python interprets it as <code>s = &#39;Bob&#39;</code> then the
rest of the line breaks the language standard.</p>

<p>Characters in literal strings must come from the ASCII character set,
which is a set of 127 character codes that is used by all modern
programming languages and computers. Unfortunately, ASCII does not have
room for non-Roman characters like accents or Eastern scripts. Unicode
strings in Python are specified with a leading u:</p>
<div class="highlight"><pre><code class="python language-python" data-lang="python">    <span class="o">&gt;</span> <span class="n">u</span> <span class="o">=</span> <span class="s">u&#39;abcdé&#39;</span>
</code></pre></div>
<p>For the rest of this lecture, we will deal with ASCII strings, because
most scientific data that is stored as text is stored with ASCII.</p>

<h2>Working with Strings</h2>

<p>Strings are iterables, which means many of the ideas from lists can also
be applied directly to string manipulation. For instance, characters can
be accessed individually or in sequences:</p>
<div class="highlight"><pre><code class="python language-python" data-lang="python">    <span class="o">&gt;</span> <span class="n">s</span> <span class="o">=</span> <span class="s">&#39;abcdefghijklmnopqrstuvwxyz&#39;</span>
    <span class="o">&gt;</span> <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="s">&#39;a&#39;</span>
    <span class="o">&gt;</span> <span class="n">s</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="s">&#39;z&#39;</span>
    <span class="o">&gt;</span> <span class="n">s</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span>
    <span class="s">&#39;bcd&#39;</span>
</code></pre></div>
<p>They can also be compared using sort and equals.</p>
<div class="highlight"><pre><code class="python language-python" data-lang="python">    <span class="o">&gt;</span> <span class="s">&#39;str1&#39;</span> <span class="o">==</span> <span class="s">&#39;str2&#39;</span>
    <span class="bp">False</span>
    <span class="o">&gt;</span> <span class="s">&#39;str1&#39;</span> <span class="o">==</span> <span class="s">&#39;str1&#39;</span>
    <span class="bp">True</span>
    <span class="o">&gt;</span> <span class="s">&#39;str1&#39;</span> <span class="o">&lt;</span> <span class="s">&#39;str2&#39;</span>
    <span class="bp">True</span>
</code></pre></div>
<p>In the help screen, which we looked at above, there are lots of
functions that look like this:</p>
<div class="highlight"><pre><code class="python language-python" data-lang="python">    <span class="o">|</span>  <span class="n">__add__</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
    <span class="o">|</span>      <span class="n">x</span><span class="o">.</span><span class="n">__add__</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">&lt;==&gt;</span> <span class="n">x</span><span class="o">+</span><span class="n">y</span>

    <span class="o">|</span>  <span class="n">__le__</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
    <span class="o">|</span>      <span class="n">x</span><span class="o">.</span><span class="n">__le__</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">&lt;==&gt;</span> <span class="n">x</span><span class="o">&lt;</span><span class="n">y</span>
</code></pre></div>
<p>These are special Python functions that interpret operations like &lt; and +.
We&#39;ll talk more about these in the next lecture on Classes.</p>

<p>Some special functions introduce handy text functions.</p>

<p><strong>Hands on example</strong></p>

<p>Try each of the following functions on a few strings. What does the
function do?</p>
<div class="highlight"><pre><code class="python language-python" data-lang="python">    <span class="o">&gt;</span> <span class="n">s</span> <span class="o">=</span> <span class="s">&quot;This is a string&quot;</span>
    <span class="o">&gt;</span> <span class="n">s</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">&quot;This&quot;</span><span class="p">)</span>
    <span class="o">&gt;</span> <span class="n">s</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&quot; &quot;</span><span class="p">)</span>
    <span class="o">&gt;</span> <span class="n">s</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="c"># This won&#39;t change every string!</span>
    <span class="o">&gt;</span> <span class="n">s</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span>
    <span class="o">&gt;</span> <span class="n">s</span><span class="o">.</span><span class="n">capwords</span><span class="p">()</span>
    <span class="o">&gt;</span> <span class="n">s</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
    <span class="o">&gt;</span> <span class="n">s</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
</code></pre></div>
<h2>File I/O</h2>

<p>Python has a built-in function called &quot;open()&quot; that can be used to
manipulate files. The help information for open is below:</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">&gt; help(open)
 Help on built-in function open in module __builtin__:

 open(...)
   open(name[, mode[, buffering]]) -&gt; file object

   Open a file using the file() type, returns a file object.  This is the
   preferred way to open a file.
</code></pre></div>
<p>The main two parameters we&#39;ll need to worry about are the name of the
file and the mode, which determines whether we can read from or write to
the file. open returns a file object, acts like a pointer into the file.
An example will make this clear. In the code below, I&#39;ve opened a file
that contains one line:</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">(unix shell) $ cat testFile.txt
abcde
fghij
</code></pre></div>
<p>Now let&#39;s open this file in Python:</p>
<div class="highlight"><pre><code class="python language-python" data-lang="python">    <span class="o">&gt;</span> <span class="n">fileHandle</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">&#39;testFile.txt&#39;</span><span class="p">,</span><span class="s">&#39;r&#39;</span><span class="p">)</span>
</code></pre></div>
<p>The second input, &#39;r&#39; means I want to open the file for reading only. I
can not write to this handle. The read() command will read a specified
number of bytes:</p>
<div class="highlight"><pre><code class="python language-python" data-lang="python">    <span class="o">&gt;</span> <span class="n">s</span> <span class="o">=</span> <span class="n">fileHandle</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
    <span class="o">&gt;</span> <span class="k">print</span> <span class="n">s</span>
    <span class="n">abc</span>
</code></pre></div>
<p>We read the first three characters, where each character is a byte long.
We can see that the file handle points to the 4th byte (index number 3)
in the file:</p>
<div class="highlight"><pre><code class="python language-python" data-lang="python">    <span class="o">&gt;</span> <span class="n">fileHandle</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span>
    <span class="il">3L</span>
    <span class="o">&gt;</span> <span class="n">fileHandle</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="s">&#39;d&#39;</span>
</code></pre></div>
<p>The file we are using is a long series of characters, but two of the
characters are new line characters. If we looked at the file in
sequence, it would look like &quot;abcdenfghijn&quot;. Separating a file into
lines is popular enough that there are two ways to read whole lines in a
file. The first is to use the readlines() method:</p>
<div class="highlight"><pre><code class="python language-python" data-lang="python">    <span class="o">&gt;</span> <span class="n">fileHandle</span><span class="o">.</span><span class="n">close</span><span class="p">()</span> <span class="c"># close the old handle</span>
    <span class="o">&gt;</span> <span class="n">fileHandle</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">&#39;testFile.txt&#39;</span><span class="p">,</span><span class="s">&#39;r&#39;</span><span class="p">)</span>
    <span class="o">&gt;</span> <span class="n">lineArr</span> <span class="o">=</span> <span class="n">fileHandle</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
    <span class="o">&gt;</span> <span class="n">lineArr</span>
    <span class="p">[</span><span class="s">&#39;abcde</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">,</span> <span class="s">&#39;fghij</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">]</span>
</code></pre></div>
<p>A very important point about the readline method is that it <em>keeps</em> the
newline character at the end of each line. You can use the strip()
method to get rid of the string.</p>

<p>File handles are also iterable, which means we can use them in for loops
or list extensions:</p>
<div class="highlight"><pre><code class="python language-python" data-lang="python">    <span class="o">&gt;</span> <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">&#39;testFile.txt&#39;</span><span class="p">,</span><span class="s">&#39;r&#39;</span><span class="p">)</span>
    <span class="o">&gt;</span> <span class="n">l</span> <span class="o">=</span> <span class="p">[</span><span class="n">s</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">f</span><span class="p">]</span>
    <span class="o">&gt;</span> <span class="n">l</span>
    <span class="p">[</span><span class="s">&#39;abcde&#39;</span><span class="p">,</span> <span class="s">&#39;fghij&#39;</span><span class="p">]</span>
    <span class="o">&gt;</span> <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="o">&gt;</span> <span class="n">l</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="o">&gt;</span> <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">&#39;testFile.txt&#39;</span><span class="p">,</span><span class="s">&#39;r&#39;</span><span class="p">)</span>
    <span class="o">&gt;</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>
         <span class="n">l</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
</code></pre></div>
<p>These are equivalent operations. It&#39;s often best to handle a file one
line at a time, particularly when the file is so large it might not fit
in memory.</p>

<p>The other half of the story is writing output to files. We&#39;ll talk about
two techniques: writing to the shell and writing to files directly.</p>

<p>If your program only creates one stream of output, it&#39;s often a good
idea to write to the shell using the print function. There are several
advantages to this strategy, including the fact that it allows the user
to select where they want to store the output without worrying about any
command line flags. You can use &quot;&gt;&quot; to direct the output of your
program to a file or use &quot;|&quot; to pipe it to another program.</p>

<p>Sometimes, you need to direct your output directly to a file handle. For
instance, if your program produces two output streams, you may want to
assign two open file handles. Opening a file for reading simply requires
changing the second option from &#39;r&#39; to &#39;w&#39; or &#39;a&#39;.</p>

<p><em>Caution!</em> Opening a file with the &#39;w&#39; option means start writing <em>at
the beginning</em>, which may overwrite old material. If you want to append
to the file without losing what is already there, open it with &#39;a&#39;.</p>

<p>Writing to a file uses the write() command, which accepts a string.</p>
<div class="highlight"><pre><code class="python language-python" data-lang="python">    <span class="o">&gt;</span> <span class="n">outFile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">&#39;outfile.txt&#39;</span><span class="p">,</span><span class="s">&#39;w&#39;</span><span class="p">)</span>
    <span class="o">&gt;</span> <span class="n">outFile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;This is the first line!&#39;</span><span class="p">)</span>
</code></pre></div>
<p>Another way to write to a file is to use writelines(), which accepts a
list of strings and writes them in order. <em>Caution!</em> writelines does not
append newlines. If you really want to write a newline at the end of
each string in the list, add it yourself.</p>

<h1>Aside: The first exercise</h1>

<p>Yesterday, we asked you to edit a file in place. Many of you asked how
this was possible. The answer is that it is not. You can use f.seek()
and f.tell() to verify that even if your file handle is pointing to the
middle of a file, write commands go to the end of the file in append
mode. The best way to change a file is to open a temporary file in
/tmp/, fill it, and then move it to overwrite the original. On large
clusters, /tmp/ is often local to each node, which means it reduces I/O
bottlenecks associated with writing large amounts of data.</p>

	</div>
      </div>

      <div class="footer">
  <a class="label swc-blue-bg" href="https://www.facebook.com/SoftwareCarpentry">Facebook</a>
  <a class="label swc-blue-bg" href="https://plus.google.com/u/0/114244759874490019250/posts">Google+</a>
  <a class="label swc-blue-bg" href="https://twitter.com/swcarpentry">Twitter</a>
  <a class="label swc-blue-bg" href="https://github.com/swcarpentry">GitHub</a>
  <a class="label swc-blue-bg" href="http://software-carpentry.org/feed.xml">RSS</a>
  <a class="label swc-blue-bg" href="../../../license.html">License</a>
  <a class="bugreport label swc-blue-bg" href="mailto:info@software-carpentry.org?subject=bug%20in%20lessons/thw-python/strings-io/tutorial.md">Bug Report</a>
</div>

    </div>
    <!-- Le javascript
================================================== -->
<!-- Placed at the end of the document so the pages load faster -->
<script src="../../../js/jquery-1.9.1.min.js"></script>
<script src="../../../js/bootstrap/bootstrap.min.js"></script>

  </body>
</html>
